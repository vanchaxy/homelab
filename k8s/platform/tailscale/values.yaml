app-template:
  serviceAccount:
    tailscale:
      forceRename: tailscale
      staticToken: true
  controllers:
    tailscale:
      serviceAccount:
        name: tailscale
      containers:
        app:
          image:
            repository: ghcr.io/tailscale/tailscale
            tag: v1.94.1@sha256:21df0b5a84efa35c0a507f4dd2340e1b1295683634a28968707354d5bd991d9c
          env:
            TS_HOSTNAME: homelab-router
            TS_USERSPACE: false
            TS_KUBE_SECRET: tailscale-tailscale-sa-token
            TS_ROUTES: 192.168.50.224/27
            TS_AUTHKEY:
              valueFrom:
                secretKeyRef:
                  name: tailscale-auth
                  key: TS_AUTHKEY
          securityContext:
            capabilities:
              add:
                - NET_ADMIN
          resources:
            limits:
              squat.ai/tun: "1"

helpers:
  infisicalSecrets:
    - name: tailscale-auth
      infisical:
        path: "/tailscale"
